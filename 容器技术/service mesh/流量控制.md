# 流量控制

## 虚拟服务(Virtual Service)

- 将流量路由到给定目标地址
- 请求地址与真实的工作负载解耦
- 包含一组路由规则
- 通常和目标规则成对出现
- 丰富的路由匹配规则

## 目标规则(Destination Rule)

- 定义虚拟服务路由目标地址的真实地址，即子集
- 设置负载均衡的方式
  - 随机
  - 权重
  - 最少请求数

## 网关

- 管理进出网格的流量
- 处在网格边界

![image-20210110213239193](.\image-20210110213239193.png)

### 服务入口(Service Entry)

- 把外部 服务注册到网格中
- 功能：
  - 为外部目标转发请求
  - 添加超时重试等策略
  - 扩展网格

![image-20210110213402449](.\image-20210110213402449.png)

### Sidecar

- 调整Envoy代理接管的端口和协议
- 限制Envoy代理可访问的服务

![image-20210110213457053](.\image-20210110213457053.png)